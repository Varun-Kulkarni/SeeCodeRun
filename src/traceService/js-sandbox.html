 <!-- 
 Order of Operation (March 26, 2016)
1) [ ] Generate Execution Trace from example code (Han)
2) [ ] Searchbox will be used to match user input in executiontrace (Dana)
3) [ ] Collect search resuts in an array. (Dana)
4) [ ] Present the results in a static table (actual UI) for the user. (Dana)
5) [ ] Make the table dynamic with the Combo box different number of columns (jQuery) (Han)
6) [ ] Integrate with Ace Editor (Dana and Han)
7) [ ] Integrate with Aurelia (Working with David)
-->
<template bindable="sandbox">
    <div id="sandBoxDiv" style="height: 1000px"></div>
</template>

<html>
    <head>
        <script src="jlinq/JSLINQ.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    </head>
    <body>
        <div id="page-wrapper">
        <h3> Search Section</h3>
        <div>
            Enter Search Term:
            <input type="textfield" id="searchTerm" placeholder="Enter"> 
            <select name="optionSelected" id="optionSelected">
              <option value="All Values">All Values</option>
              <option value="variableDeclaration">Variable Declaration</option>
              <option value="expression">expression</option>
            </select>
        </div>
        <br/>
        <h3> Search Results:</h3>
        <pre id='searchResultDisplayArea'></pre>
    </div>
    <script>
    /* global jlinq */
        window.onload = function(){
            var queryTerm = document.getElementById('searchTerm');
            var displayArea = document.getElementById('searchResultDisplayArea');
            // sample source code for playing with jlinq
            var source = [  {"ID":1, var:"x", "type":"expression"},
                            {"ID":2, var:"y", "type":"expression"},
                            {"ID":3, var:"z", "type":"Literal"},
                            {"ID":4, var:"z", "type":"Literal"},
                            {"ID":5, var:"y", "type":"expression"}
                        ];
           
            $("#searchTerm").change(function(e){
                //var searchedTerm = parseInt(this.value);//filter by ID
                var searchedTerm = this.value; //filter by type
                var usingJlinq = JSLINQ(source);
                // returns an object array of the queried results
               var select = document.getElementById("optionSelected");
               var option = select.options[select.selectedIndex].value;
              
               if(option == "All Values")
               {
                   var query = usingJlinq.Where(function(item){return item.ID == searchedTerm}).ToArray();
               }
               else if(option == "variableDeclaration")
               {
                    var query = usingJlinq.Where(function(item){return item.var == searchedTerm}).ToArray();
               }
                else if(option == "expression")
               {
                    var query = usingJlinq.Where(function(item){return item.type == searchedTerm}).ToArray();
               }
                
            
                var qData1, qData2, qData3;
                var allAssociatedKeys = "";
                var table =" ";
                var i;
                var number=0;
                
                table = "<table border='1'>";
                for(i=0;i<query.length;i++){
                    // for(var key in query2[i]){
                    //     allAssociatedKeys+="key:"+key+"\n";
                    // }
                    qData1 = "ID"+":"+parseInt(query[i].ID);
                    qData2 = "var"+":"+query[i].var;
                    qData3 = "type"+":"+query[i].type;
                  
                    number++;
                   
                    table += "<tr><td>" +  "Row No. " + "</td>" + "<td>"+  number + " " +"</td>" 
                            + "<td>" + qData1 + "</td>" 
                            + "<td>" + qData2 + "</td>" 
                            + "<td>" + qData3 + "</td> </tr>";
                   
                }
               table += "</table><br/>";
                
                //displayArea.innerHTML = JSON.stringify(query2);
                displayArea.innerHTML =  table;
            });
        }
        </script>
    </body>
</html>