 <!-- 
 Order of Operation (March 26, 2016)
1) [ ] Generate Execution Trace from example code (Han)
2) [ ] Searchbox will be used to match user input in executiontrace (Dana)
3) [ ] Collect search resuts in an array. (Dana)
4) [ ] Present the results in a static table (actual UI) for the user. (Dana)
5) [ ] Make the table dynamic with the Combo box different number of columns (jQuery) (Han)
6) [ ] Integrate with Ace Editor (Dana and Han)
7) [ ] Integrate with Aurelia (Working with David)
-->
<template bindable="sandbox">
    <div id="sandBoxDiv" style="height: 1000px"></div>
</template>

<html>
    <head>
        <script src="jlinq/JSLINQ.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    </head>
    <body>
        <div id="page-wrapper">
        <h3> Search Section</h3>
        <div>
            Enter Search Term:
            <input type="textfield" id="searchTerm" placeholder="Enter 'expression'"> 
            <select name="" id="">
              <option value="All Values">All Values</option>
              <option value="variableDeclaration">Variable Declaration</option>
              <option value="expression">expression</option>
            </select>
        </div>
        <br/>
        <h3> Search Results:</h3>
        <pre id='searchResultDisplayArea'></pre>
    </div>
    <script>
    /* global jlinq */
        window.onload = function(){
            var queryTerm = document.getElementById('searchTerm');
            var displayArea = document.getElementById('searchResultDisplayArea');
            // sample source code for playing with jlinq
            var source = [  {"ID":1, var:"x", "type":"expression"},
                            {"ID":2, var:"y", "type":"expression"},
                            {"ID":3, var:"z", "type":"expression"}];
           
            $("#searchTerm").change(function(e){
                var searchedTerm1 = parseInt(this.value);
                var searchedTerm2 = this.value;
                var usingJlinq = JSLINQ(source);
                // returns a object array of the queried results
                var table =" ";
                var query1 = usingJlinq.Where(function(item){return item.ID == searchedTerm1}).ToArray();
                var query2 = usingJlinq.Where(function(item){return item.type == searchedTerm2}).ToArray();
                var qData = "Query Result:\n";
                var allAssociatedKeys = "";
                var i;
                for(i=0;i<query2.length;i++){
                    for(var key in query2[i]){
                        allAssociatedKeys+="key:"+key+"\n";
                    }
                    qData += "ID"+":"+query2[i].ID+"\n";
                    qData += "var"+":"+query2[i].var+"\n";
                    qData += "type"+":"+query2[i].type+"\n";
                } 
                
                
                table = "<table>";
                for(var i=0; i < query2.length; i=i+3){
                    table += "<th>Results</th>";
                    table += "<tr><td>" + JSON.stringify(query2[i]) + "</td></tr>";
                    if(i+1 < query2.length){
                       table += "<tr><td>" + ( query2[i+1]===undefined ? '' :JSON.stringify(query2[i+1]) )+"</td></tr>";
                    }
                    else if(i+2 < query2.length){
                        table += "<tr><td>" + ( query2[i+2]===undefined ? '' : JSON.stringify(query2[i+2]))+"</td></tr>";
                    }
                     else if(i+3 < query2.length){
                        table += "<tr><td>" + ( query2[i+3]===undefined ? '' : JSON.stringify(query2[i+3]) )+"</td></tr>";
                    }
                    else{
                        table += "<tr><td>no data</td></tr>";
                    }
                }
               table += "<table><br /> <br />";
                
                //displayArea.innerHTML = JSON.stringify(query2);
                displayArea.innerHTML =  table;
            });
        }
        </script>
    </body>
</html>